<!doctype html>
<html>

<head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
        integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
        integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
        integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
        crossorigin="anonymous"></script>
    <meta charset="utf-8" />
    <title>Animations</title>
</head>

<body id="body">
    <div class="jumbotron">
        <h1 class="display-4">Asmmetrik Animation Design Challenge</h1>
        <hr class="my-4">
        <div style="text-align: left">
            <p>Instructions: </p>
            <p>As stated the application is able to pause, play, and switch between animations. Most of the controls are
                done through keystrokes. The mapping is listed below:<br>
                'P' -> Pause/Play Animation<br>
                'Spacebar' -> Switch Animation<br>
                'A' -> Decrease Pane Size Width<br>
                'D' -> Increase Pane Size Width<br>
                'W' -> Increase Pane Height<br>
                'S' -> Decrease Pane Height<br>
                The mapping is case insensitive.
            </p>
        </div>
    </div>

    <style type="text/css">
        body {
            background: #ccc;
            /* text-align: center; */
        }

        #canvas {
            top: 50%;
            left: 50%;
            transform: translateX(-50%) translateY(-50%);
            box-shadow: 0 0 10px 0 #999;
        }
    </style>
    <script>
        function initAnimation1() {
            var canvas = document.createElement('canvas');
            document.body.appendChild(canvas);
            document.getElementById("body").style.textAlign = "center";
            var context = canvas.getContext('2d');
            canvas.width = 800;
            canvas.height = 400;
            var paused = false;
            var speed = 50;
            var opacity = 0.7;
            var snowy = true;

            //instaniate image object for trees, either snowy or rainy.
            //the default is snowy
            var imgPath = 'image-removebg-preview.png';
            var imgObject = new Image();

            var treePath = '3-36870_polar-wallpaper-tree-snow-bear-creative-pine-clipart-removebg-preview.png';
            var treeObject = new Image();
            treeObject.src = treePath;
            imgObject.src = imgPath;

            var flakes = [];
            document.addEventListener('keypress', function (event) {
                if (event.key == 'p' || event.key == 'P') {
                    paused = !paused;
                }

                // BEGIN WIDTH INCREASE/DECREASE PROCESSING CHECK
                if (event.key == 'a' || event.key == 'A') {
                    console.log(canvas.width);
                    if (canvas.width == 400) {
                        // alert that the value is already at lowest
                        window.alert("The width is already at the lowest value!");
                    }
                    else {
                        decreasePanel("w");
                    }
                }
                if (event.key == 'd' || event.key == 'D') {
                    if (canvas.width + 10 > window.screen.width) {
                        // too large
                        window.alert("The width will exceed the window size!")
                    }
                    else {
                        increasePanel("w");
                    }
                }
                // END INCREASE/DECREASE PROCESSING CHECK
                // BEGIN HEIGHT INCREASE/DECREASE PROCESSING CHECK
                if (event.key == 'w' || event.key == 'W') {
                    increasePanel("h");
                }
                if (event.key == 's' || event.key == 'S') {
                    decreasePanel("h");
                }
                // END INCREASE/DECREASE PROCESSING CHECK

                if (event.key == ' ') {
                    // we have to change the animation values from:
                    // snow to rain
                    // snowy trees to fall trees
                    // white ground to green ground
                    snowy = !snowy;
                }
                console.log(event.key);
            })

            function increasePanel(val) {
                if (val == 'w') {
                    canvas.width += 10;
                }
                else {
                    canvas.height += 10;
                }
            }

            function decreasePanel(val) {
                if (val == 'w') {
                    canvas.width -= 10;
                }
                else {
                    canvas.height -= 10;
                }
            }
            var counter = 1;
            function snowfall() {
                drawCanvas();
                addElement();
                fall();
            };
            function drawCanvas() {
                var styleBackground = "";
                var groundColor = "";
                var treeObjectPath = "";
                var treeOffsetValueBigX, treeOffsetValueBigY, treeOffsetValueSmallX, treeOffsetValueSmallY;
                if (snowy) {
                    styleBackground = "grey";
                    groundColor = "white";
                    treePath = '3-36870_polar-wallpaper-tree-snow-bear-creative-pine-clipart-removebg-preview.png';
                    treeObject.src = treePath;
                    treeOffestValueBigX = -50;
                    treeOffsetValueBigY = -380;
                    treeOffsetValueSmallX = -350;
                    treeOffsetValueSmallY = -200;
                }
                else {
                    styleBackground = "rgba(51, 102, 204,1.0)";
                    groundColor = "rgb(0, 102, 0, 1.0)";
                    treePath = 'unnamed.png';
                    treeObject.src = treePath;
                    treeOffestValueBigX = -50;
                    treeOffsetValueBigY = -550;
                    treeOffsetValueSmallX = -350;
                    treeOffsetValueSmallY = -235;
                    opacity = 0.3;
                }

                context.clearRect(0, 0, canvas.width, canvas.height);
                context.fillStyle = styleBackground;
                context.fillRect(0, 0, canvas.width, canvas.height);
                context.fillStyle = groundColor;
                context.fillRect(0, canvas.height - 40, canvas.width, 40);
                context.drawImage(treeObject, treeOffestValueBigX, canvas.height + treeOffsetValueBigY);
                context.drawImage(treeObject, canvas.width + treeOffsetValueSmallX, canvas.height + treeOffsetValueSmallY, 200, 200);
            };
            function addElement() {
                if (!paused) {
                    var x = Math.ceil(Math.random() * canvas.width);
                    var s = Math.ceil(Math.random() * 4);
                    flakes.push({ "x": x, "y": 0, "s": s });
                }
            };

            // function addLeaf() {

            // }
            function fall() {
                for (var i = 0; i < flakes.length; i++) {
                    var flake = flakes[i];
                    var add_value;

                    if (!paused) {
                        add_value = flake.s / 2;
                    }
                    else {
                        add_value = 0;
                    }
                    var add = 3;
                    context.beginPath();
                    context.fillStyle = "rgba(255, 255, 255, " + opacity + ")";
                    context.arc(flake.x, flakes[i].y += add_value, flake.s / 2, 0, 2 * Math.PI);
                    // console.log(add);
                    // context.drawImage(imgObject, imgObject.y += add, imgObject.x += add, 100, 30);
                    context.fill();
                    if (flakes[i].y > canvas.height) {
                        flakes.splice(i, 1);
                    }
                };
            };
            setInterval(snowfall, 10);
        };
        window.onload = initAnimation1;
    </script>
</body>

</html>